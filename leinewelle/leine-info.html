<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

  <head>
    <script type="javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-NK9PKNV');</script>
    <meta name="verify-v1" content="N4t1FFHRz/ixDoATYjDAC4gLrWaPliPD5z6fD4Kdl0k=" />
    <meta name="author" content="Jan Hinzmann" />
    <meta name="description" content="Homepage von Jan Hinzmann" />

    <link rel="stylesheet" type="text/css" href="../style/janhinzmann.css" />

    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <title>JH Leine-Infos</title>
  </head>

  <body>
    <div style="text-align: center;margin:20px;">
      <a href="../"><img alt="Jan Hinzmann" src="../img/janhinzmann2.png" /></a>
    </div>

    <div class="nav">
      <ul>
        <li><img src="../favicon/favicon-32x32.png" style="padding: 10px 10px 4px 7px;" /></li>
        <li><a href="http://janhinzmann.de/">Home</a></li>
        <li><a href="#" class="active">Leinewelle</a></li>
        <li><a href="http://janhinzmann.de/stories/">Stories</a></li>
        <li><a href="http://janhinzmann.de/uni/">Uni</a></li>
        <li style="float:right"><a href="../about.html">About</a></li>
      </ul>
    </div>

    <div class="content">
        <h3 class="header">Wavemaster Toolbox</h3>
        <div class="entry">
            <div>
              <h2>Wasser: <span id="messstelle"> ... loading </span></h2>
              <h3><span id="datum"></span></h3>
            </div>
            <br/>
            <div>
              Temperatur: <b><span id="wassertemperatur"> ... loading </span></b> (in Sarstedt)<br />
              Pegelstand: <b><span id="pegel"> ... loading </span></b>, 
              <span id="trend"> ... loading </span>
            </div>
            <br />
            <div>Entwicklung</div>
            <div>
              <span id="zeitpunkt_gestern"></span><b> <span id="wert_gestern"> ... loading </span></b>
              <br/>
              <span id="zeitpunkt_heute"></span><b> <span id="wert_heute"> ... loading </span></b>
              <br/>
              Differenz: <b><span id="pegelDifferenz"> ... loading </span></b>  
            </div>
            <br />
            <div>
              <small>
                <b><span id="grundablass">Grundablass</span></b>
                <div>
                  <span>länger &gt; 180: öffnet</span>
                  <br />
                  <span>länger &lt; 160: schließt</span>
              </small>
            </div>
            <br />
            <div>
              <span id="meldestufe"> ... loading </span> 
              <span id="meldestufen"> ... loading </span><br/>
            </div>
            <!--<div><span id="datum"> ... loading </span></div>
            <div>Pegel: <span id="pegel"> ... loading </span></div>
            <div>Trend: <span id="trend"> ... loading </span></div>
            -->
            
            <!--
              <div><h2>Messstelle: <span id="messstelleTemperatur"> ... loading </span></h2></div>
              <div><b>Datum: </b><span id="datumTemperatur"> ... loading </span></div>
              <div><b>Wassertemperatur: </b><span id="wassertemperaturDetail"> ... loading </span></div>
              -->
              
            <br />
            <div><small>Daten von <a href="https://www.pegelonline.nlwkn.niedersachsen.de/Pegel/Binnenpegel/ID/378">NLWKN (Koldingen)</a></small></div>
            <div><small>Daten von <a href="https://www.pegelonline.nlwkn.niedersachsen.de/Pegel/Binnenpegel/ID/325">NLWKN (Herrenhausen)</a></small></div>
                  
            <br />
            <h1>Wetter</h1>
            <small><a href="https://www.wetteronline.de/blitzradar/hannover?wrx=52.19,9.74">Blitzradar Hannover</a></small><br/>
            <small>Warnungen f&uuml;r Niedersachsen, Bremen</small>
            <div id="warnungen" class="hidden">
              <p>
                <b>
                  <span id="wetterWarnungUeberschrift"></span>
                </b>
                
                <small>
                  <span id="wetterWarnungZeitpunk"></span>
                </small>
              </p>
              <p>
                <b>
                  <span id="wetterWarnungRegionsName"></span>
                </b>
                
                <span id="wetterWarnungMeldung"></span>
              </p>
            </div>
            
            <div><a href="https://www.dwd.de/DE/wetter/warnungen/warnWetter_node.html?ort=Hannover" target="_blank"><img src="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib.png"/></a></div>
            <br />
            <div>Weitere Warnkarten: 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_regen.png">Regen</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_uv.png">UV</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_gewitter.png">Gewitter</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_sturm.png">Wind</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_schnee.png">Schnee</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_nebel.png">Nebel</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_frost.png">Frost</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_frost.png">Glatteis</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_frost.png">Tauwetter</a>, 
              <a href="https://www.dwd.de/DWD/warnungen/warnapp_gemeinden/json/warnungen_gemeinde_map_nib_frost.png">Hitze</a>
            </div>
            <div><br/><small>Daten von <a href="https://www.dwd.de/DE/wetter/warnungen/warnWetter_node.html?ort=Hannover" target="_blank">DWD</a></small></div>
        </div>
        <small><small><div style="text-align:right;"><sub>~ &nbsp;</sub></div></small></small>
    </div>
    <div class="footer">2006-2025 Jan Hinzmann</div>
    <script>
        const statIDKoldingen=378;
        const statIDPoppenburg=486;
        const statIDGreene=287;
        const statIDLeineturm=400;
        const statIDHerrenhausen=325;
        
        // Wasserpegel
        let pegelOnlineStationsdaten = "https://bis.azure-api.net/PegelonlinePublic/REST/stammdaten/stationen/STAT_ID?key=9dc05f4e3b4a43a9988d747825b39f43";
        let pegelOnlineStationsdatenUrl = pegelOnlineStationsdaten.replace("STAT_ID", statIDKoldingen);
        fetch(pegelOnlineStationsdatenUrl)
            .then(function (response) { return response.json(); })
            .then(function (pegelData) {
                let messstelle = pegelData.getStammdatenResult[0].Name;
                let messstellenDaten = pegelData.getStammdatenResult[0].Parameter[0].Datenspuren[0];
                let date = messstellenDaten.AktuellerMesswert_Zeitpunkt + " Uhr";
                let pegel = messstellenDaten.AktuellerMesswert + " cm";
                let trend = messstellenDaten.Trend;
                let meldestufe = "Meldestufe " + messstellenDaten.AktuelleMeldeStufe;
                let meldestufenDefinition = messstellenDaten.Meldestufen;
                let meldestufen = "<br/><small>";
                meldestufenDefinition.forEach(element => {
                  meldestufen += element.Stufe + " > " + element.Wert + " cm<br/>";
                });
                meldestufen = meldestufen.slice(0, meldestufen.length -2) + "</small>";

                document.getElementById("messstelle").innerHTML = messstelle;
                document.getElementById("datum").innerHTML = date;
                document.getElementById("pegel").innerHTML = pegel;
                document.getElementById("trend").innerHTML = trend;
                document.getElementById("meldestufe").innerHTML = meldestufe;
                document.getElementById("meldestufen").innerHTML = meldestufen;
            });
        // Wasserpegel Differenz 
        let pegelOnlineMessreihen = "https://bis.azure-api.net/PegelonlinePublic/REST/station/STAT_ID/datenspuren/parameter/1/tage/-1?key=9dc05f4e3b4a43a9988d747825b39f43";
        let pegelOnlineMessreihenUrl = pegelOnlineMessreihen.replace("STAT_ID", statIDKoldingen);
        fetch(pegelOnlineMessreihenUrl)
            .then(function (response) { return response.json(); })
            .then(function (pegelData) {
                let pegelstaende = pegelData.getPegelDatenspurenResult.Parameter[0].Datenspuren[0].Pegelstaende;
                
                let pegelstandHeuteWert = pegelstaende[0].Wert;
                let pegelstandGesternWert = pegelstaende[pegelstaende.length -1].Wert;
                
                let pegelstandHeuteZeitpunktWS = pegelstaende[0].Datum;
                let pegelstandHeuteClean = pegelstandHeuteZeitpunktWS.replace("/Date(", "").replace(")/", "").replace("+0000","");
                let pegelstandHeuteNumber = new Number(pegelstandHeuteClean);
                let pegelstandHeuteDate = new Date(pegelstandHeuteNumber);
                let pegelstandHeuteFormatiert = ("0" + pegelstandHeuteDate.getDate()).slice(-2)  + "." 
                  + ("0" + (pegelstandHeuteDate.getMonth()+1)).slice(-2) + "." 
                  + ("0" + pegelstandHeuteDate.getFullYear()).slice(-2) + " " 
                  + ("0" + pegelstandHeuteDate.getHours()).slice(-2) + ":" 
                  + ("0" + pegelstandHeuteDate.getMinutes()).slice(-2) + " Uhr";
                let pegelstandHeuteZeitpunkt = pegelstandHeuteFormatiert;

                let pegelstandGesternZeitpunktWS = pegelstaende[pegelstaende.length -1].Datum;
                let pegelstandGesternClean = pegelstandGesternZeitpunktWS.replace("/Date(", "").replace(")/", "").replace("+0000","");
                let pegelstandGesternNumber = new Number(pegelstandGesternClean);
                let pegelstandGesternDate = new Date(pegelstandGesternNumber);
                let pegelstandGesternFormatiert = ("0" + pegelstandGesternDate.getDate()).slice(-2)  + "." 
                  + ("0" + (pegelstandGesternDate.getMonth()+1)).slice(-2) + "." 
                  + ("0" + pegelstandGesternDate.getFullYear()).slice(-2) + " " 
                  + ("0" + pegelstandGesternDate.getHours()).slice(-2) + ":" 
                  + ("0" + pegelstandGesternDate.getMinutes()).slice(-2) + " Uhr";
                let pegelstandGesternZeitpunkt = pegelstandGesternFormatiert;

                let pegelstandDifferenz = pegelstandHeuteWert - pegelstandGesternWert;
                if(pegelstandDifferenz > 0 ) {
                  pegelstandDifferenz = "+" + pegelstandDifferenz;
                }
                document.getElementById("wert_heute").innerHTML = pegelstandHeuteWert + " cm";
                document.getElementById("zeitpunkt_heute").innerHTML = pegelstandHeuteZeitpunkt;
                document.getElementById("wert_gestern").innerHTML = pegelstandGesternWert + " cm";
                document.getElementById("zeitpunkt_gestern").innerHTML = pegelstandGesternZeitpunkt;
                document.getElementById("pegelDifferenz").innerHTML = pegelstandDifferenz  + " cm";
            });
            
        // Temperatur
        let pegelOnlineAlleGueteStationenDaten = "https://bis.azure-api.net/Pegelonline/REST/stammdaten/stationen/AlleGuetestationen?subscription-key=19094e54510d4e89b140ff2d3abf715f";
        let pegelOnlineAlleGueteStationenDatenUrl = pegelOnlineAlleGueteStationenDaten;
        fetch(pegelOnlineAlleGueteStationenDatenUrl)
            .then(function (response) { return response.json(); })
            .then(function (alleGueteStationenData) {
                let alleGueteStationen = alleGueteStationenData.getStammdatenResult;
                let gueteStationSarstedt = alleGueteStationen.filter((value)=>{ return value.Name == "Sarstedt"; })[0];
                //let gueteStationSarstedt = alleGueteStationen.filter((value)=>{ return value.Name == "Poppenburg"; })[0];
                let gueteStationSarstedtName = gueteStationSarstedt.Name; // "Name": "Sarstedt",
                let gueteStationSarstedtDatum = gueteStationSarstedt.Parameter[0].Datenspuren[0].AktuellerMesswert_Zeitpunkt + " Uhr";
                let gueteStationSarstedtWert = gueteStationSarstedt.Parameter[0].Datenspuren[0].AktuellerMesswert_Text;

                //document.getElementById("messstelleTemperatur").innerHTML = gueteStationSarstedtName;
                //document.getElementById("datumTemperatur").innerHTML = gueteStationSarstedtDatum;
                document.getElementById("wassertemperatur").innerHTML = gueteStationSarstedtWert;
                //document.getElementById("wassertemperaturDetail").innerHTML = gueteStationSarstedtWert;
            });
        
        let wetterWarnungenUrl = "https://www.dwd.de/DWD/warnungen/warnapp/json/warnings.json";  
        fetch(wetterWarnungenUrl)
            .then(function (response) { return response.text(); })
            .then(function (responseText) { return responseText.substring("warnWetter.loadWarnings(".length, responseText.length - ");".length); })
            .then(function (responsetextJson) { return JSON.parse(responsetextJson); })
            .then(function (warnungen) {
              let wetterWarnungZeitpunk = new Date(warnungen.time);
              let wochenTage = ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"];
              let wetterWarnungZeitpunkTag = wetterWarnungZeitpunk.getDay();
              
              let wetterWarnungZeitpunkFormatiert = wochenTage[ wetterWarnungZeitpunkTag ] + ", "
                  + ("0" + wetterWarnungZeitpunk.getDate()).slice(-2)  + "." 
                  + ("0" + (wetterWarnungZeitpunk.getMonth()+1)).slice(-2) + "." 
                  + ("0" + wetterWarnungZeitpunk.getFullYear()).slice(-2) + " " 
                  + ("0" + wetterWarnungZeitpunk.getHours()).slice(-2) + ":" 
                  + ("0" + wetterWarnungZeitpunk.getMinutes()).slice(-2) + " Uhr";
              
              // nds / Hannover = 103241000
              // nds / Osnabrück = 903459999
              let wetterWarnungHannover = warnungen.warnings['103241000'][0];
              let wetterWarnungRegionsName = wetterWarnungHannover.regionName;
              let wetterWarnungUeberschrift = wetterWarnungHannover.headline;
              let wetterWarnungMeldung = wetterWarnungHannover.description;

              document.getElementById("warnungen").classList.remove("hidden");
              document.getElementById("warnungen").classList.add("warnings");
              document.getElementById("wetterWarnungZeitpunk").innerHTML = wetterWarnungZeitpunkFormatiert;
              document.getElementById("wetterWarnungRegionsName").innerHTML = wetterWarnungRegionsName + "<br/>";
              document.getElementById("wetterWarnungUeberschrift").innerHTML = wetterWarnungUeberschrift + "<br/>";
              document.getElementById("wetterWarnungMeldung").innerHTML = wetterWarnungMeldung;
            });
        
    </script>
  </body>
</html>
